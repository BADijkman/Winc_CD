name: Run Tests

on:
  push:
    branches:
      - master
      
jobs:
  run-tests:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Setup Python 3.11
        uses: actions/setup-python@v3
        with:
          python-version: "3.11.0"
      - name: Install Dependencies
        run: python -m pip install --upgrade pip
          pip install -r requirements.txt
      - name: Run tests
        run: pytest

      - name: Debug SSH Private Key
        run: |
          echo "$SSH_PRIVATE_KEY" > private_key.pem
          cat private_key.pem
        env:
          SSH_PRIVATE_KEY: ${{ secrets.SSH_PRIVATE_KEY }}

      # - name: Copy file
      #   if: ${{ success() }}
      #   uses: appleboy/scp-action@master
      #   with:
      #     host: ${{ secrets.HOST }}
      #     username: ${{ secrets.USERNAME }}
      #     key: ${{ secrets.SSH_PRIVATE_KEY }}
      #     source: "."
      #     target: "/home/Winc_CD"

      # - name: Deploy to VPS
      #   if: ${{ success() }}
      #   uses: appleboy/ssh-action@master
      #   with:
      #     host: ${{ secrets.HOST }}
      #     username: ${{ secrets.USERNAME }}
      #     key: ${{ secrets.SSH_PRIVATE_KEY }}
      #     script: |
      #       cd /home/Winc_CD
      #       sudo systemctl restart Winc_CD
